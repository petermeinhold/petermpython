
from petermpython import planck_util as pu
import healpy as hp
from glob import glob
base='/global/project/projectdirs/planck/data/mission/DPC_maps/dx9_delta/lfi/'
fla=glob(base+'LFI*19_22*survey*.fits')
fla.sort()
flafull=glob(base+'LFI*19_22_full*.fits')
dbs1=pu.get_surv_diff_fname(fla[0],flafull[0],fwhm=1.,freq=70,pol='Q')
dbs2=pu.get_surv_diff_fname(fla[1],flafull[0],fwhm=1.,freq=70,pol='Q')
dbs3=pu.get_surv_diff_fname(fla[2],flafull[0],fwhm=1.,freq=70,pol='Q')
dbs4=pu.get_surv_diff_fname(fla[3],flafull[0],fwhm=1.,freq=70,pol='Q')
dbs5=pu.get_surv_diff_fname(fla[4],flafull[0],fwhm=1.,freq=70,pol='Q')
psdbs1=pu.rescan_to_psmap(dbs1,startring=3,stopring=5483,stepring=1,ang=qr.det_opening_angles['LFI19M'])
psdbs2=pu.rescan_to_psmap(dbs2,startring=5484,stopring=10957,stepring=1,ang=qr.det_opening_angles['LFI19M'])
psdbs3=pu.rescan_to_psmap(dbs3,startring=10958,stopring=16454,stepring=1,ang=qr.det_opening_angles['LFI19M'])
psdbs4=pu.rescan_to_psmap(dbs4,startring=16455,stopring=21482,stepring=1,ang=qr.det_opening_angles['LFI19M'])
psdbs5=pu.rescan_to_psmap(dbs5,startring=21483,stopring=27404,stepring=1,ang=qr.det_opening_angles['LFI19M'])
import quickring as qr
psdbs1=pu.rescan_to_psmap(dbs1,startring=3,stopring=5483,stepring=1,ang=qr.det_opening_angles['LFI19M'])
psdbs2=pu.rescan_to_psmap(dbs2,startring=5484,stopring=10957,stepring=1,ang=qr.det_opening_angles['LFI19M'])
psdbs3=pu.rescan_to_psmap(dbs3,startring=10958,stopring=16454,stepring=1,ang=qr.det_opening_angles['LFI19M'])
psdbs4=pu.rescan_to_psmap(dbs4,startring=16455,stopring=21482,stepring=1,ang=qr.det_opening_angles['LFI19M'])
psdbs5=pu.rescan_to_psmap(dbs5,startring=21483,stopring=27404,stepring=1,ang=qr.det_opening_angles['LFI19M'])
psdbs1=pu.rescan_to_psmap(dbs1,startring=3,stopring=5483,stepring=5,ang=qr.det_opening_angles['LFI19M'])
psdbs2=pu.rescan_to_psmap(dbs2,startring=5484,stopring=10957,stepring=5,ang=qr.det_opening_angles['LFI19M'])
psdbs3=pu.rescan_to_psmap(dbs3,startring=10958,stopring=16454,stepring=5,ang=qr.det_opening_angles['LFI19M'])
psdbs4=pu.rescan_to_psmap(dbs4,startring=16455,stopring=21482,stepring=5,ang=qr.det_opening_angles['LFI19M'])
psdbs5=pu.rescan_to_psmap(dbs5,startring=21483,stopring=27404,stepring=5,ang=qr.det_opening_angles['LFI19M'])
imshow(psdbs1,cmap='gray')
imshow(psdbs1)
imshow(psdbs2)
imshow(psdbs2)
imshow(psdbs3)
imshow(psdbs4)
imshow(psdbs5)
imshow(psdbs1)
title('Pseudomap, LFI 70 GHz quad 19-22 SS1- full Q')
xlabel('Clock angle, 0-250/rev'),ylabel('relative PID/5')
imshow(psdbs2)
title('Pseudomap, LFI 70 GHz quad 19-22 SS2- full Q')
imshow(psdbs3)
title('Pseudomap, LFI 70 GHz quad 19-22 SS3- full Q')
imshow(psdbs4)
title('Pseudomap, LFI 70 GHz quad 19-22 SS4- full Q')
imshow(psdbs5)
title('Pseudomap, LFI 70 GHz quad 19-22 SS5- full Q')